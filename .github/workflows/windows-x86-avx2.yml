name: windows-x64_avx2
on: [push, pull_request]
jobs:
  windows-x86:
    runs-on: windows-latest
    steps:
    - name: cancel-previous-runs
      uses: styfle/cancel-workflow-action@0.7.0
      with:
        access_token: ${{ secrets.GITHUB_TOKEN }}
    - uses: actions/checkout@v2
      with:
        submodules: true
    - name: cache-wget
      id: cache-wget
      uses: actions/cache@v1
      with:
        path: "wget-install"
        key: wget-windows-install
    - name: wget
      run: |
        mkdir software && cd software
        Invoke-WebRequest -Uri https://github.com/JulioGold/wget/archive/refs/heads/master.zip -OutFile wget.zip
        7z x ./wget.zip
        $Env:path=$Env:Path+";D:\a\bolt\bolt\software\wget-master\wget\bin"
        cd ..
        cmake -version
        mingw32-make -version
        ./install.sh --target=windows-x86_64_avx2
        echo "*** check wget"
        wget -h
        echo "*** check wget done"
        echo "*** compile done"
